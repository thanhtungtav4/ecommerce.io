!function($){"use strict";$(document).ready(function(){var d=$("#admin_devvn_reviews_nonce").val(),e=!1;$("body").on("click",".sync_old_reviews",function(){var a=$(this).closest("tr"),b=$(".mess",a);return e||$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"devvn_reviews_sync_cmt",nonce:d},context:this,beforeSend:function(){b.html("\u0110ang ch\u1EA1y..."),e=!0},success:function(a){a.success?b.css("color","green").html(a.data):b.css("color","red").html(a.data),e=!1},error:function(a,c,d){b.css("color","red").html("C\xf3 l\u1ED7i x\u1EA3y ra!"),e=!1}}),!1});var f=!1;$("body").on("click",".fake_reviews_bought",function(){var a=$(this).closest("tr"),b=$(".mess",a);return f||$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"fake_reviews_bought",nonce:d},context:this,beforeSend:function(){b.html("\u0110ang ch\u1EA1y..."),f=!0},success:function(a){a.success?b.css("color","green").html(a.data):b.css("color","red").html(a.data),f=!1},error:function(a,c,d){b.css("color","red").html("C\xf3 l\u1ED7i x\u1EA3y ra!"),f=!1}}),!1}),$("body").on("click",".admin_fake_label",function(){var a=$(this).data("id"),b=$(this).data("nonce");return f||$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"admin_fake_label",id:a,nonce:b},context:this,beforeSend:function(){$(this).text(devvn_reviews.text_loading),f=!0},success:function(a){a.success?($(this).after(devvn_reviews.text_done),$(this).remove()):$(this).text(devvn_reviews.text_error),f=!1},error:function(a,b,c){$(this).text(devvn_reviews.text_error),f=!1}}),!1}),$("body").on("change","#review_position_select",function(){"custom"==$(this).val()?$(".review_position_action").addClass("active"):$(".review_position_action").removeClass("active")});var g=!1;$("body").on("click",".open_comment_prod",function(){var a=$(this).closest("tr"),b=$(".mess",a);return g||$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"open_comment_prod",nonce:d},context:this,beforeSend:function(){b.html("\u0110ang ch\u1EA1y..."),g=!0},success:function(a){a.success?b.css("color","green").html(a.data):b.css("color","red").html(a.data),g=!1},error:function(a,c,d){b.css("color","red").html("C\xf3 l\u1ED7i x\u1EA3y ra!"),g=!1}}),!1});var h=!1;$("body").on("click",".reviews_active_license",function(){var a=$("#reviews_license").val(),b=$(this).data("nonce"),c=$(this).closest("td");return a&&!h&&$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"active_license_reviews",license:a,nonce:b},context:this,beforeSend:function(){h=!0,$(".spinner",c).css({visibility:"visible"})},success:function(a){a.success?(alert(a.data),location.reload()):alert(a.data),h=!1,$(".spinner",c).css({visibility:"hidden"})},error:function(b,a,d){alert(a),h=!1,$(".spinner",c).css({visibility:"hidden"})}}),!1});var i=1,j=0,k=0;function l(a){let h=$(".mess",a.closest("tr")),b=a.data("type"),c=parseInt($("#fake_sold_from").val())||0,e=parseInt($("#fake_sold_to").val())||0,g=parseInt($("#fake_per_page").val())||20;f||$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"fake_sold_prod",sold_type:b,sold_form:c,sold_to:e,fake_per_page:g,fake_paged:i,nonce:d},context:this,beforeSend:function(){0==j&&h.html("\u0110ang ch\u1EA1y..."),f=!0},success:function(b){if(b.success){let d=b.data.complete,e=parseInt(b.data.number);if(j+=e,d){let c="\u0110\xe3 fake xong. T\u1EA5t c\u1EA3 c\xf3 "+j+" s\u1EA3n ph\u1EA9m \u0111\xe3 \u0111\u01B0\u1EE3c fake s\u1ED1 l\u01B0\u1EE3ng \u0111\xe3 b\xe1n.";h.css("color","green").html(c),alert(c),i=1,j=0}else h.css("color","green").html("\u0110\xe3 fake "+j+" s\u1EA3n ph\u1EA9m. \u0110ang ch\u1EA1y..."),f=!1,i++,l(a)}else h.css("color","red").html(b.data),alert(b.data),i=1,j=0;f=!1},error:function(b,a,c){h.css("color","red").html("C\xf3 l\u1ED7i x\u1EA3y ra! "+a),f=!1}})}$("body").on("click",".fake_sold_prod",function(){return!0==confirm("B\u1EA1n c\xf3 ch\u1EAFc ch\u1EAFn kh\xf4ng? Khi \u0111ang Fake th\xec kh\xf4ng \u0111\u01B0\u1EE3c t\u1EAFt c\u1EEDa s\u1ED5 n\xe0y cho t\u1EDBi khi xong ho\u1EB7c b\xe1o l\u1ED7i nh\xe9!")&&(l($(this)),!1)});var m=!1;function n(a){var b=$(a).closest("tr"),e=$(".mess",b);let c=parseInt($("#auto_per_page").val())||20;f||$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"autoreviews_prod",auto_per_page:c,fake_paged:i,nonce:d},context:this,beforeSend:function(){0==j&&e.html("\u0110ang ch\u1EA1y..."),f=!0},success:function(b){if(console.log(b),b.success){let d=b.data.complete,g=parseInt(b.data.number),h=parseInt(b.data.rv_count);if(j+=g,k+=h,d){let c="\u0110\xe3 \u0111\xe1nh gi\xe1 xong. T\u1EA5t c\u1EA3 c\xf3 "+k+" \u0111\xe1nh gi\xe1 /"+j+" s\u1EA3n ph\u1EA9m \u0111\xe3 \u0111\u01B0\u1EE3c \u0111\xe1nh gi\xe1.";e.css("color","green").html(c),alert(c),i=1,j=0,k=0}else e.css("color","green").html("\u0110\xe3 c\xf3 "+k+" \u0111\xe1nh gi\xe1 /"+j+" s\u1EA3n ph\u1EA9m. \u0110ang ch\u1EA1y..."),f=!1,i++,n(a)}else e.css("color","red").html(b.data),alert(b.data),i=1,j=0,k=0;f=!1},error:function(b,a,c){e.css("color","red").html("C\xf3 l\u1ED7i x\u1EA3y ra! "+a),f=!1}})}function a(){let a=parseInt($("#auto_reviews_number_reviews").val())||0,b=parseInt($("#auto_reviews_number_reviews_to").val())||0;a>b&&$("#auto_reviews_number_reviews_to").val(a)}if($("body").on("click",".reset_sold",function(){if(!0!=confirm("B\u1EA1n c\xf3 ch\u1EAFc ch\u1EAFn mu\u1ED1n reset s\u1ED1 l\u01B0\u1EE3ng \u0111\xe3 b\xe1n kh\xf4ng?"))return!1;var a=$(this).closest("tr"),b=$(".mess",a);return g||$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"reset_sold",nonce:d},context:this,beforeSend:function(){b.html("\u0110ang ch\u1EA1y..."),m=!0},success:function(a){a.success?b.css("color","green").html(a.data):b.css("color","red").html(a.data),m=!1},error:function(a,c,d){b.css("color","red").html("C\xf3 l\u1ED7i x\u1EA3y ra!"),m=!1}}),!1}),$("body").on("click",".devvn_gm_addimages",function(d){d.preventDefault();var a,b=$(this),c=b.closest(".devvn_gm_wrap"),e=c.find("#attachment_img"),f=c.find("ul.devvn_gm_images");if(a){a.open();return}(a=wp.media.frames.product_gallery=wp.media({title:b.data("choose"),button:{text:b.data("update")},states:[new wp.media.controller.Library({title:b.data("choose"),filterable:"all",multiple:!0})]})).on("select",function(){var c=a.state().get("selection"),d=e.val();c.map(function(a){if((a=a.toJSON()).id){d=d?d+","+a.id:a.id;var c=a.sizes&&a.sizes.thumbnail?a.sizes.thumbnail.url:a.url;a.filename&&a.filename,f.append('<li class="image" data-attachment_id="'+a.id+'"><div class="li_img_box"><img src="'+c+'" /><ul class="actions"><li><a href="#" class="gm_delete" title="'+b.data("delete")+'"><span class="dashicons dashicons-no-alt"></span></a></li></ul></div></li>')}}),e.val(d)}),a.open()}),$("body").on("click",".devvn_gm_images a.gm_delete",function(){var a=$(this).closest(".devvn_gm_wrap"),b=a.find("#attachment_img");$(this).closest("li.image").remove();var c="";return a.find("ul li.image").each(function(){var a=jQuery(this).attr("data-attachment_id");c=c?c+","+a:a}),b.val(c),!1}),$("body").on("click",".go_auto_reviews",function(){if(!0==confirm("B\u1EA1n \u0111\xe3 l\u01B0u c\xe0i \u0111\u1EB7t ch\u01B0a? N\u1EBFu ch\u01B0a th\xec \u1EA5n cancel. N\u1EBFu \u0111\xe3 l\u01B0u th\xec \u1EA5n okie \u0111\u1EC3 ti\u1EBFp t\u1EE5c")&& !0==confirm("B\u1EA1n c\xf3 ch\u1EAFc ch\u1EAFn mu\u1ED1n \u0111\xe1nh gi\xe1 t\u1EF1 \u0111\u1ED9ng cho t\u1EA5t c\u1EA3 s\u1EA3n ph\u1EA9m kh\xf4ng?"))return n($(this)),!1}),a(),$("#auto_reviews_number_reviews, #auto_reviews_number_reviews_to").on("change",function(){a()}),void 0!==$.fn.datepicker&&$("#date_reviews_form").length>0){var b=$("#date_reviews_form"),c=$("#date_reviews_to");$("#date_reviews_form, #date_reviews_to").datepicker({dateFormat:"yy-mm-dd"}),b.on("change",function(){c.datepicker("option","minDate",b.val())}),c.on("change",function(){b.datepicker("option","maxDate",c.val())})}$("#cat_reviews").length>0&&$("#cat_reviews").select2()})}(jQuery)