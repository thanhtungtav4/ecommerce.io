(()=>{"use strict";var e={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}e.r(t);var d,u,f,h,v,p,y=jQuery,g=y(document);y("body");"undefined"!=typeof yith_wcaf&&(d=null===(h=yith_wcaf)||void 0===h?void 0:h.ajax_url,u=null===(v=yith_wcaf)||void 0===v?void 0:v.nonces,f=null===(p=yith_wcaf)||void 0===p?void 0:p.labels);function m(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e,t,n,i,r){var o=y(this);i instanceof FormData?(i.append("action","yith_wcaf_".concat(t)),i.append("security",null!=u&&u[n]?null==u?void 0:u[n]:n)):i=w({action:"yith_wcaf_".concat(t),security:null!=u&&u[n]?null==u?void 0:u[n]:n},i);var a=w({url:d,data:i,method:e,beforeSend:function(){return o.length&&function(e){if(void 0===y.fn.block)return!1;try{return e.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e}catch(e){return!1}}(o)},complete:function(){return o.length&&function(e){if(void 0===y.fn.unblock)return!1;try{e.unblock()}catch(e){return!1}}(o)}},r);return y.ajax(a)};const k={request:_,get:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _.call.apply(_,[this,"get"].concat(t))},post:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _.call.apply(_,[this,"post"].concat(t))}};var j=function(){function e(t,i,r){n(this,e),m(this,"$container",void 0),m(this,"objectType",void 0),m(this,"objectID",void 0),null!=t&&t.length&&(this.$container=t,this.objectType=i,this.objectID=r,this.$notesList=this.$container.find(".order_notes"),this.$addButton=this.$container.find("#add_note"),this.$noteContent=this.$container.find("#add_order_note"),this.$emptyMsg=this.$notesList.find(".no_notes"),this.init())}return a(e,[{key:"init",value:function(){var e=this;this.$container.on("click",".delete_note",(function(t){t.preventDefault();var n=y(this).closest(".note");e.deleteNote(n)})),this.$addButton.on("click",(function(t){t.preventDefault();var n=e.$noteContent.val();n?e.addNote(n):e.$noteContent.parent().addClass("woocommerce-invalid")})),this.$noteContent.on("keyup",(function(){e.$noteContent.val()&&e.$noteContent.parent().removeClass("woocommerce-invalid")}))}},{key:"addNote",value:function(e){var t=this;k.post.call(this.$container,"add_note","add_note",{object_id:this.objectID,object_type:this.objectType,note_content:e}).done((function(e){var n;if(null!=e&&e.success&&null!=e&&null!==(n=e.data)&&void 0!==n&&n.template){var i=y(e.data.template);t.$notesList.prepend(i),t.$noteContent.val(""),t.$emptyMsg.hide(),i.get(0).scrollIntoView()}}))}},{key:"deleteNote",value:function(e){var t=this;k.post.call(e,"delete_note","delete_note",{object_id:this.objectID,object_type:this.objectType,note_id:e.attr("rel")}).done((function(n){null!=n&&n.success&&(e.remove(),t.$notesList.find("li").not(t.$emptyMsg).length||t.$emptyMsg.show())}))}}]),e}(),$=function(){function e(t){var i,r;n(this,e),m(this,"$container",void 0),m(this,"$fields",void 0),m(this,"dependencies",{}),this.$container=t,null!==(i=this.$container)&&void 0!==i&&i.length&&(this.initFields(),null!==(r=this.$fields)&&void 0!==r&&r.length&&this.initDependencies())}return a(e,[{key:"initFields",value:function(){this.$fields=this.$container.find(":input")}},{key:"initDependencies",value:function(){this.buildDependenciesTree(),Object.keys(this.dependencies).length&&this.handleDependencies()}},{key:"buildDependenciesTree",value:function(){var e=this;this.$fields.closest("[data-dependencies]").each((function(){var t=y(this),n=t.attr("id");if(n){var i=m({},n,t.data("dependencies"));e.dependencies=y.extend(e.dependencies,i)}})),this.$container.find("[data-dep-target]").each((function(){var t=y(this),n=t.data("dep-id"),i=t.data("dep-target"),r=t.data("dep-value");if(n&&i&&r){var o=m({},i,m({},n,r.toString().split(",")));e.dependencies=y.extend(e.dependencies,o)}}))}},{key:"handleDependencies",value:function(){this.$fields.on("change",this.applyDependencies.bind(this)),this.applyDependencies()}},{key:"applyDependencies",value:function(){var e=this;y.each(this.dependencies,(function(t,n){var i=e.findFieldContainer(t);i.length&&(e.checkConditions(n)?null==i||i.fadeIn():null==i||i.hide())}))}},{key:"findField",value:function(e){var t=this.$container.find("#".concat(e));return t.length||(t=this.$container.find("#".concat(e,"_field"))),!!t.length&&(t.is(":input")||(t=t.find(":input")),t)}},{key:"findFieldContainer",value:function(e){var t=this.findField(e);if(null==t||!t.length)return!1;var n=t.closest("#".concat(e,"_container"));return n.length||(n=t.closest(".form-row")),n.length||(n=t.closest("tr")),!!n.length&&n}},{key:"checkConditions",value:function(e){var t=this,n=!0;return y.each(e,(function(e,i){var r,o=t.findField(e);if(n&&null!=o&&o.length){var a,l;if(o.first().is('input[type="radio"]'))r=null===(a=o.filter(":checked"))||void 0===a||null===(a=a.val())||void 0===a?void 0:a.toString();else r=null==o||null===(l=o.val())||void 0===l?void 0:l.toString();n=Array.isArray(i)?i.includes(r):"function"==typeof i?i(r):0===i.indexOf(":")?o.is(i):0===i.indexOf("!:")?!o.is(i.toString().substring(1)):0===i.indexOf("!")?i.toString().substring(1)!==r:i.toString()===r,void 0!==t.dependencies[e]&&(n=n&&t.checkConditions(t.dependencies[e]))}})),n}}]),e}();var O=function(){function e(t){var i;n(this,e),m(this,"$container",void 0),m(this,"ERROR_CLASS","woocommerce-invalid"),this.$container=t,null!==(i=this.$container)&&void 0!==i&&i.length&&this.initValidation()}return a(e,[{key:"initValidation",value:function(){this.initForm(),this.initFields()}},{key:"initForm",value:function(){var e=this.$container.is("form")?this.$container:this.$container.find("form");if(e.length){var t=this;e.on("submit yith_wcaf_validate_fields",(function(e){var n=y(this);return!!t.validateForm(n)||(e.stopImmediatePropagation(),!1)}))}}},{key:"initFields",value:function(){var e=this.getFields(this.$container);if(e.length){var t=this;e.on("keyup change",(function(){var e=y(this);t.validateField(e)}))}}},{key:"getFieldWrapper",value:function(e){return e.closest(".form-row, .yith-plugin-fw-panel-wc-row")}},{key:"getFields",value:function(e){return y("input, select, textarea",e).not('input[type="submit"]').not('input[type="hidden"]').not(".select2-search__field")}},{key:"getVisibleFields",value:function(e){var t=this;return this.getFields(e).filter((function(e,n){var i=y(n);return t.getFieldWrapper(i).is(":visible")}))}},{key:"isFieldValid",value:function(e){var t=this.getFieldWrapper(e),n=e.attr("type"),i=e.val();if(e.prop("required")||t.hasClass("required")||t.hasClass("validate-required")||t.hasClass("yith-plugin-fw--required")||["reg_username","reg_email","reg_password"].includes(e.get(0).id)){if("checkbox"===n&&!e.is(":checked"))throw"missing";if(!i)throw"missing"}var r=t.data("pattern");if(r&&!new RegExp(r).test(i))throw"malformed";var o=t.data("min_length");if(o&&i.length<o)throw"short";var a=t.data("max_length");if(a&&i.length>a)throw"long";if("number"===n){var l=parseFloat(e.attr("min")),c=parseFloat(e.attr("max")),s=parseFloat(i);if(l&&l>s||c&&c<s)throw"overflow"}return!0}},{key:"validateField",value:function(e){try{this.isFieldValid(e)}catch(t){return this.reportError(e,t),!1}return this.removeError(e),!0}},{key:"validateForm",value:function(e){var t=this.getVisibleFields(e);if(!t.length)return!0;var n=this,i=!0;return t.each((function(){var e=y(this);n.validateField(e)||(i=!1)})),!!i||(this.scrollToFirstError(e),!1)}},{key:"getErrorMsg",value:function(e,t){var n,i,r,o,a,l=e.data("error");if(l)return l;var c=this.getFieldWrapper(e);return(l=c.data("error"))||(l=c.find("label").data("error"))?l:!(null==f||!f.errors)&&("missing"===t&&(l="checkbox"===e.attr("type")?null===(n=f.errors)||void 0===n?void 0:n.accept_check:null===(i=f.errors)||void 0===i?void 0:i.compile_field)?l:l=null!==(r=f.errors)&&void 0!==r&&r[t]?null===(o=f.errors)||void 0===o?void 0:o[t]:null===(a=f.errors)||void 0===a?void 0:a.general_error)}},{key:"reportError",value:function(e,t){var n=this.getFieldWrapper(e),i=this.getErrorMsg(e,t);if(n.addClass(this.ERROR_CLASS),i){n.find(".error-msg").remove();var r=y("<span/>",{class:"error-msg",text:i});n.append(r)}}},{key:"removeError",value:function(e){var t=this.getFieldWrapper(e),n=t.find(".error-msg");t.removeClass(this.ERROR_CLASS),n.remove()}},{key:"scrollToFirstError",value:function(e){var t=e.find(".".concat(this.ERROR_CLASS)).first();if(t.length){var n=this.findScrollableParent(e);n&&n.length||(n=y("html, body"));var i=t.offset().top-n.offset().top,r=i;n.is("html, body")||(r=n.get(0).scrollTop+i),n.animate({scrollTop:r})}}},{key:"findScrollableParent",value:function(e){var t,n,i=e.get(0);if(!i)return null;do{if(document===i)return null;n="visible"!==(t=window.getComputedStyle(i).overflowY)&&"hidden"!==t}while(!(n&&i.scrollHeight>i.clientHeight)&&(i=i.parentNode));return y(i)}}]),e}();var F=function(e,t){if(void 0!==y.fn.selectWoo){var n=!!e.data("allow_clear"),i=e.data("placeholder"),r=e.data("minimum_input_length"),o=e.data("action"),a={allowClear:n,placeholder:i,minimumInputLength:r||3};!!o&&(a.ajax={url:d,dataType:"json",delay:250,data:function(t){return{term:t.term,action:o,security:e.data("security"),exclude:e.data("exclude"),include:e.data("include"),limit:e.data("limit")}},processResults:function(e){var t=[];return e&&y.each(e,(function(e,n){t.push({id:e,text:n})})),{results:t}},cache:!0}),a=y.extend(a,t||{});try{e.selectWoo(a).addClass("enhanced")}catch(e){}}},C=function(e){var t;void 0!==y.fn.datepicker&&(null!==(t=e)&&void 0!==t&&t.length||(e=g),y(".yith-wcaf-enhanced-date-picker",e).add(".date-picker-field",e).add(".date-picker",e).not(".enhanced").each((function(){!function(e){if(void 0!==y.fn.datepicker){var t=e.data("format"),n=e.data("number-of-months"),i=e.data("max-date"),r=e.data("min-date"),o=e.data("altfield"),a=e.data("altformat"),l={dateFormat:t||"yy-mm-dd",numberOfMonths:n||1,maxDate:i||null,minDate:r||null,altField:o?e.next(o).get(0):null,altFormat:a||"",beforeShow:function(e,t){var n;null==t||null===(n=t.dpDiv)||void 0===n||null===(n=n.addClass("yith-wcaf-datepicker"))||void 0===n||n.addClass("yith-plugin-fw-datepicker-div")},onClose:function(e,t){var n;null==t||null===(n=t.dpDiv)||void 0===n||null===(n=n.removeClass("yith-wcaf-datepicker"))||void 0===n||n.removeClass("yith-plugin-fw-datepicker-div")}};try{e.datepicker(l).addClass("enhanced")}catch(e){}}}(y(this))})))},S=function(e){var t;null!==(t=e)&&void 0!==t&&t.length||(e=g);var n=y(".yith-wcaf-accordion",e).not(".enhanced");n.length&&n.each((function(){!function(e){var t=y(".accordion-radio",e);t.length&&(t.on("change",(function(){var n=t.filter(":checked").closest(".accordion-option").find(".accordion-content");y(".accordion-content",e).not(n).slideUp(),n.slideDown()})).trigger("change"),e.addClass("enhanced"))}(y(this))}))},x=function(e){var t;null!==(t=e)&&void 0!==t&&t.length||(e=g);var n=y(".yith-wcaf-attach-file",e).not(".enhanced");n.length&&n.each((function(){var e,t,n=y(this);(t=(e=n).parent().find('input[type="file"]')).length&&(e.on("click",(function(e){e.preventDefault(),t.trigger("click")})).addClass("enhanced"),t.on("change",(function(t){var n=t.target.files,i=[],r=e.next("small.files-list");for(var o in n)n.hasOwnProperty(o)&&i.push(n[o].name);if(i.length){if(r.length||(r=y("<small/>",{class:"files-list"}),e.after(r)),r.text(i.join(", ")),e.hasClass("auto-submit")){var a=e.closest("form");if(!a.length)return;a.submit()}}else r.length&&r.remove()})))}))},D=function(e){var t;null!==(t=e)&&void 0!==t&&t.length||(e=g),function(e){var t;void 0!==y.fn.selectWoo&&(null!==(t=e)&&void 0!==t&&t.length||(e=g),y(".yith-wcaf-enhanced-select",e).not(".enhanced").each((function(){var e=y(this);F(e)})))}(e),C(e),S(e),x(e),function(e){var t;null!==(t=e)&&void 0!==t&&t.length||(e=g),new $(e)}(e),function(e){var t;null!==(t=e)&&void 0!==t&&t.length||(e=g),new O(e)}(e),y(".yith-wcaf-enhanced-template",e).not(".enhanced").each((function(){var e=y(this),t=e.find(".editor");y("a.toggle_editor",e).text((function(){var e=y(this);e.text(e.data("view-label"))})).on("click",(function(){var e=y(this),n=t.is(":visible");return e.text(e.data("".concat(n?"view":"hide","-label"))),t.slideToggle(),!1})),y("a.delete_template",e).on("click",(function(){return window.confirm(y(this).data("confirm"))})),y("textarea",t).on("change",(function(){var e=y(this),t=e.attr("data-name");t&&e.attr("name",t)})),e.addClass("enhanced")})),y(".editable",e).not(".enhanced").one("click",(function(){var e=y(this),t=e.parent(),n=t.find(".edit");n&&(t.find(".edited").slideUp(),n.slideDown(),e.removeClass("editable"))})).addClass("enhanced"),y("[data-postfix]",e).not(".enhanced").each((function(){var e=y(this),t=y("<span/>",{class:"field-postfix",text:e.data("postfix"),style:"line-height: 2.5; margin-left: 5px;"});e.after(t)})),y((function(){var t=[".yith-plugin-fw-list-table-container"];y("input, textarea, select",e).on("change",(function(){y(this).closest(t.join(", ")).length&&(window.onbeforeunload=null)}))}))};function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=s(e);if(t){var r=s(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c(this,n)}}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(i,e);var t=P(i);function i(){var e;n(this,i);var r=y("#yith_wcaf_panel_commissions-list").add("#yith_wcaf_panel_commission_details");return(e=t.call(this,r)).initNotes(),e}return a(i,[{key:"initNotes",value:function(){var e=y("#commission_notes"),t=y("#commission_id");e.length&&t.length&&new j(e,"commission",t.val())}}]),i}(function(){function e(t){n(this,e),m(this,"$container",void 0),this.$container=t,this.initFields(),this.initBulkAction()}return a(e,[{key:"initFields",value:function(){D(this.$container)}},{key:"initBulkAction",value:function(){var e=y("#bulk-action-selector-top",this.$container);e.length&&F(e,{minimumResultsForSearch:1/0,minimumInputLength:0})}}]),e}());y((function(){return new R}));var E=window;for(var T in t)E[T]=t[T];t.__esModule&&Object.defineProperty(E,"__esModule",{value:!0})})();