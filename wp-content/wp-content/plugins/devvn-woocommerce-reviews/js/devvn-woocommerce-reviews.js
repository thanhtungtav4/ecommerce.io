!function($,a){"use strict";$(document).ready(function(){function b(){var a=devvn_reviews.star_1,b=devvn_reviews.star_2,c=devvn_reviews.star_3,d=devvn_reviews.star_4,e=devvn_reviews.star_5;$("body p.stars a").each(function(f){switch(f){case 0:$(this).html(a);break;case 1:$(this).html(b);break;case 2:$(this).html(c);break;case 3:$(this).html(d);break;case 4:$(this).html(e)}}),$("body").on("click","#respond p.stars a",function(){var g=$(this),f=$(this).closest("#respond").find("#rating");switch($(this).closest(".stars"),g.text()){case a:f.val(1);break;case b:f.val(2);break;case c:f.val(3);break;case d:f.val(4);break;case e:f.val(5)}}),$("body p.stars a.star-5").trigger("click")}b(),$("body").on("init",function(){b()}),$(window).on("load",function(){setTimeout(function(){b()},1e3)});var d=parseInt(devvn_reviews.number_img_upload),e=$(".devvn_attach_view"),f=$(".list_attach");function c(){var b=$("#countContent"),a=$("#comment").val();if(0==(a=$.trim(a)).length){b.text("0 "+devvn_reviews.minlength_text2);return}a.split(/\W/),b.text(a.length+" "+devvn_reviews.minlength_text2)}function g(){$(".devvn_attach_view li").length<=d-1&&$(".devvn_attach_view li").length>0?f.addClass("show-btn"):f.removeClass("show-btn")}$("body").on("keyup","#comment",function(){c()}),c(),$.validator.addMethod("vietnamphone",function(a,b){return!devvn_reviews.vietnamphone||/^0+(\d{9,10})$/.test(a)},"H\xe3y \u0111i\u1EC1n \u0111\xfang s\u1ED1 \u0111i\u1EC7n tho\u1EA1i"),$.validator.addMethod("customemail",function(a,b){return""==a||/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(a)},"\u0110\u1ECBnh d\u1EA1ng email kh\xf4ng \u0111\xfang."),$("#commentform").validate({invalidHandler:function(b,a){a.numberOfInvalids()?$("div.error").show():$("div.error").hide()},rules:{author:{required:!0,minlength:2},phone:{required:{depends:function(){return $(this).val($.trim($(this).val())),!0}},vietnamphone:!0,minlength:2},email:{customemail:!0},comment:{required:function(a){return!($('input[name="quick_tag[]"]:checked').length>0)},minlength:devvn_reviews.cmt_length}},messages:{author:devvn_reviews.name_required_text,email:devvn_reviews.email_required_text,phone:devvn_reviews.phone_required_text,comment:{required:devvn_reviews.cmt_required_text,minlength:devvn_reviews.minlength_text}},errorElement:"div",errorPlacement:function(a,b){b.after(a)},submitHandler:function(a){var b=$(a).attr("action");return $.ajax({url:b,type:"POST",data:new FormData(a),processData:!1,contentType:!1,beforeSend:function(){$("#review_form_wrapper, #respond").addClass("devvn_loading")},success:function(c,e){let d=new DOMParser().parseFromString(c,"text/html"),b=$(d).find(".wp-die-message").text();if(b)return alert(b),$("#review_form_wrapper, #respond").removeClass("devvn_loading"),$("body li.review #respond #cancel-comment-reply-link").trigger("click"),!1;$("#review_form_wrapper, #respond").removeClass("devvn_loading"),alert(devvn_reviews.review_success),$("#comment",a).val(""),$(".devvn_attach_view",a).html(""),$("body li.review #respond #cancel-comment-reply-link").trigger("click"),$.magnificPopup.close()},error:function(a,c,d){let b=new DOMParser().parseFromString(a.responseText,"text/html");alert($(b).find(".wp-die-message").text()),$("#review_form_wrapper, #respond").removeClass("devvn_loading"),$("body li.review #respond #cancel-comment-reply-link").trigger("click")}}),!1}}),$("body").on("click",".btn-reviews-now",function(){if($("ol.commentlist .comment-respond").length<=0)$.magnificPopup.open({items:{src:"#review_form_wrapper",type:"inline"},showCloseBtn:!1,closeOnBgClick:!1,modal:!0,mainClass:"devvn-reviews-popup"});else{var a=$(".commentlist #respond").offset().top;$("html, body").animate({scrollTop:a-44},500)}}),$(document).on("click",".fancybox-close-small",function(a){a.preventDefault(),$.magnificPopup.close()}),$("body").on("click",".devvn_insert_attach",function(){if($(this).closest("#commentform"),!1==(($(".devvn_attach_view li").each(function(){$("input",this).val()?$(this).removeClass("li_file_hide"):$(this).remove()}),$(".devvn_attach_view li").length>=d)?(f.removeClass("show-btn"),!1):(f.addClass("show-btn"),!0)))alert(devvn_reviews.file_length_text);else{var a=$.now(),b='<li id="li_files_'+a+'" class="li_file_hide"><div class="img-wrap"><span class="close">&times;</span><div class="img-wrap-box"></div></div><div class="'+a+'"><input type="file" name="attach[]" id="files_'+a+'" accept="image/jpeg, image/png, image/gif, image/x-png"></div></li>';e.append(b),g(),$("#files_"+a).trigger("click")}return!1}),$("body").on("click",".img-wrap .close",function(){$(this).closest("li").remove(),g()}),$("body").on("change",'[name="attach[]"]',function(b){if(b.target.files){var a=b.target.files[0],e=$(this);if(a){var d,c=new FileReader;c.onload=(d=a,function(j){var f,h,b,l,c,i,a,k;(!1==("image/jpeg"==(a=(f=d).type)||"image/png"==a||"image/x-png"==a||"image/gif"==a)?(alert(devvn_reviews.file_format_text),1):!1==(k=f.size)<devvn_reviews.img_size?(alert(devvn_reviews.file_size_text),1):0)?e.closest("li").remove():(h=j,b=d,c=e.closest("li"),i='<img class="thumb" src="'+h.target.result+'" title="'+encodeURI(b.name)+'" data-id="'+b.name+'"/>',$(".img-wrap-box",c).html(i),c.removeClass("li_file_hide"),g()),g()}),c.readAsDataURL(a)}}}),$("body").on("init",function(){$("#commentform").length>0&&($("#commentform")[0].encoding="multipart/form-data")});var h=!1;function i(){$(".cmt_attachment_img").each(function(){$(this).magnificPopup({delegate:"a",type:"image",mainClass:"devvn-reviews-popup mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:0}})})}$("body").on("init",function(){var b=$("#devvn_cmt"),c=$(".devvn_prod_cmt");b.validate({onclick:!1,onkeyup:!1,onfocusout:!1,rules:{devvn_cmt_name:{required:!0,minlength:2},devvn_cmt_phone:{required:!0,minlength:8},devvn_cmt_email:{customemail:!0},devvn_cmt_content:{required:!0,minlength:devvn_reviews.cmt_length}},messages:{devvn_cmt_name:devvn_reviews.name_required_text,devvn_cmt_email:devvn_reviews.email_required_text,devvn_cmt_phone:devvn_reviews.phone_required_text,devvn_cmt_content:{required:devvn_reviews.cmt_required_text,minlength:devvn_reviews.minlength_text}},errorPlacement:function(a,b){alert(a.text())},submitHandler:function(a){if(!h){var b=$(a).serialize(),d=$("#devvn_cmt_content",a).val(),e=$('input[name="devvn_cmt_gender"]',a).val(),f=$("#devvn_cmt_name",a).val(),g=$("#devvn_cmt_phone",a).val(),i=$("#devvn_cmt_email",a).val();return $.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"devvn_cmt_submit",cmt_data:b,content:d,gender:e,name:f,email:i,phone:g},context:this,beforeSend:function(){h=!0,c.addClass("devvn_loading")},success:function(b){b.success?(b.data.result&&b.data.fragments&&$.each(b.data.fragments,function(a,b){$(a).html(b)}),alert(b.data.messages),$("#devvn_cmt_content",a).val(""),$("#devvn_cmt_search",c).val("")):alert(b.data),h=!1,c.removeClass("devvn_loading")},error:function(a,b,d){alert(a.responseText),h=!1,c.removeClass("devvn_loading")}}),!1}}});var d=a.template("reply-devvn-cmt");$("body").on("click",".devvn_cmt_reply",function(){$(".devvn_cmt_list_box #devvn_cmt_reply").remove();var a=$(this).closest("li"),b=$(this).attr("data-cmtid"),e="@"+$(this).attr("data-authorname")+": ";$(".devvn_cmt_child",a).length>0?$(".devvn_cmt_child li:nth-child(1)",a).prepend(d({parent_id:b,authorname:e})):a.append(d({parent_id:b,authorname:e}));var f=$(".devvn_cmt_list_box #devvn_cmt_reply #devvn_cmt_replycontent"),g=f.val();f.val("").focus().val(g);var i=$(".devvn_cmt_list_box #devvn_cmt_reply");return i.validate({onclick:!1,onkeyup:!1,onfocusout:!1,rules:{devvn_cmt_replyname:{required:!0,minlength:2},devvn_cmt_replyphone:{required:!0},devvn_cmt_replyemail:{customemail:!0},devvn_cmt_replycontent:{required:!0,minlength:devvn_reviews.cmt_length}},messages:{devvn_cmt_replyname:devvn_reviews.name_required_text,devvn_cmt_replyphone:devvn_reviews.phone_required_text,devvn_cmt_replyemail:devvn_reviews.email_required_text,devvn_cmt_replycontent:{required:devvn_reviews.cmt_required_text,minlength:devvn_reviews.minlength_text}},errorPlacement:function(a,b){alert(a.text())},submitHandler:function(a){if(!h){var b=$(a).serialize(),d=$("#devvn_cmt_replycontent",a).val(),e=$('input[name="devvn_cmt_replygender"]',a).val(),f=$("#devvn_cmt_replyname",a).val(),g=$("#devvn_cmt_replyphone",a).val(),i=$("#devvn_cmt_replyemail",a).val();return $.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"devvn_cmt_submit",cmt_data:b,content:d,gender:e,name:f,phone:g,email:i},context:this,beforeSend:function(){h=!0,c.addClass("devvn_loading")},success:function(b){b.success?(b.data.result&&b.data.fragments&&$.each(b.data.fragments,function(a,b){$(a).html(b)}),alert(b.data.messages),$("#devvn_cmt_content",a).val(""),$("#devvn_cmt_search",c).val("")):alert(b.data),$(".devvn_cmt_list_box #devvn_cmt_reply").remove(),h=!1,c.removeClass("devvn_loading")},error:function(a,b,d){alert(a.responseText),h=!1,c.removeClass("devvn_loading")}}),!1}}}),!1}),$("body").on("click",".devvn_cancel_cmt",function(){$(this).closest("#devvn_cmt_reply").remove()}),$("body").on("submit","#devvn_cmt_search_form",function(){var a=$("#devvn_cmt_search",this).val(),b=$(this).serialize();return h||$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"devvn_cmt_search",search:a,formData:b},context:this,beforeSend:function(){h=!0,c.addClass("devvn_loading")},success:function(a){a.success?a.data.result&&a.data.fragments&&$.each(a.data.fragments,function(a,b){$(a).html(b)}):alert(a.data),h=!1,c.removeClass("devvn_loading")},error:function(a,b,d){alert(a.responseText),h=!1,c.removeClass("devvn_loading")}}),!1}),$("body").on("click",".devvn_cmt_paged a",function(){var a=$(this).attr("href"),b=parseInt(a.replace("#tcomment-page=","")),d=$("#devvn_cmt_search",c).val(),e=$("#devvn_cmt_search_form",c).serialize();return h||$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"devvn_cmt_load_paged",search:d,formData:e,paged:b},context:this,beforeSend:function(){h=!0,c.addClass("devvn_loading")},success:function(a){a.success?a.data.result&&a.data.fragments&&$.each(a.data.fragments,function(a,b){$(a).html(b)}):alert(a.data),h=!1,c.removeClass("devvn_loading")},error:function(a,b,d){alert(a.responseText),h=!1,c.removeClass("devvn_loading")}}),!1})}),$("body").on("init",function(){i()});var j=!1;$("body").on("click",".cmtlike",function(a){if(a.preventDefault(),!j&&!$(this).hasClass("liked")){var b=parseInt($(this).data("id")),c=parseInt($(this).data("like"))||0,d=$(".cmt_count",this);$.ajax({type:"post",dataType:"json",url:devvn_reviews.ajax_url,data:{action:"devvn_like_cmt",id:b},context:this,beforeSend:function(){j=!0,d.html(c+1)},success:function(a){a.success?$(this).addClass("liked"):d.html(c),j=!1},error:function(a,b,e){j=!1,d.html(c)}})}}),$("body.single-product").on("click","div#reviews ul.page-numbers li a",function(c){c.preventDefault();let b=$(this).attr("href"),a=$(this).closest("#reviews"),d=$(".commentlist",a),e=$(".woocommerce-pagination",a);a.addClass("devvn_loading"),b&&$.post(b,function(a){let b=$(a).find("div#reviews .commentlist").html(),c=$(a).find("div#reviews .woocommerce-pagination").html(),f=$(".single-product #reviews #comments").offset().top;$("html, body").animate({scrollTop:f},500),d.html(b),e.html(c),$(".commentlist .lazy-load").each(function(){let a=$(this).attr("data-src");a&&$(this).attr("src",a)}),$(document).trigger("devvn_reviews_loaded")}).done(function(){a.removeClass("devvn_loading"),i()}).fail(function(){alert("C\xf3 l\u1ED7i x\u1EA3y ra")})})})}(jQuery,wp)